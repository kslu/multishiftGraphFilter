#include "../src/filters.h"
#include "../src/grfilter.h"
#include "../src/matrices.h"

#define LEN 32

int main(int argc, char *argv[]) {

  double input32[32] = {0.3041, 0.4868, 0.9101, 0.8521, 0.9781, 0.6740, 0.9982,
                        0.1307, 0.7803, 0.9581, 0.6719, 0.4030, 0.6437, 0.0349,
                        0.7468, 0.2155, 0.8643, 0.6717, 0.6606, 0.9273, 0.1661,
                        0.1734, 0.6295, 0.3849, 0.9915, 0.6498, 0.5767, 0.3216,
                        0.8256, 0.0776, 0.2773, 0.6198};
  double output32[32];

  // test case 1
  double b1[2] = {0.8, 0.4};
  double a1[4] = {1, 0.8, 0.4, 0.2};

  arma_gf_cg(input32, output32, LEN, 20, 1, b1, 3, a1, NE_LD32, Ld32_a, Ld32_w);
  // MATLAB output: [0.3043, 0.4360, 0.6218, 0.6952, 0.7084, 0.6340, 0.5839,
  // 0.4258, 0.5469, 0.6294, 0.5412, 0.4205, 0.3715, 0.2757, 0.3802, 0.3874,
  // 0.5354, 0.5647, 0.5641, 0.5228, 0.3029, 0.2556, 0.3775, 0.4555, 0.5972,
  // 0.5468, 0.4598, 0.3921, 0.4083, 0.2587, 0.2837, 0.3974]
  fprintf(stderr, "Output, c2: [");
  for (int i = 0; i < 32; i++)
    fprintf(stderr, "%f, ", output32[i]);
  fprintf(stderr, "]\n");

  // test case 2
  double b2[6] = {0.1379, 0.2178, 0.1821, 0.0418, 0.1069, 0.6164};
  double a2[18] = {0.9397, 0.3545, 0.4106, 0.9843, 0.9456, 0.6766,
                   0.9883, 0.7668, 0.3367, 0.6624, 0.2442, 0.2955,
                   0.6802, 0.5278, 0.4116, 0.6026, 0.7505, 0.5835};

  memset(output32, 0, 32 * sizeof(double));

  // arma_gf_cg(input32, output32, LEN, 200, 5, b2, 17, a2, NE_LD32, Ld32_a,
  // Ld32_w);
  arma_gf_cg(input32, output32, LEN, 32, 5, b2, 17, a2, NE_LD32, Ld32_a,
             Ld32_w);
  // MATLAB output: [0.2524, -0.1577, -0.2264, 0.2854, 0.6347, 0.2327, -0.3843,
  // -0.3191, 0.3292, 0.6095, 0.1461, -0.3373, -0.1574, 0.3197, 0.3190, -0.1222,
  // -0.2559, 0.1721, 0.5233, 0.2583, -0.2504, -0.3037, 0.1048, 0.3682, 0.2041,
  // -0.0273, 0.0111, 0.1452, 0.0884, -0.0522, -0.0060, 0.1609]
  fprintf(stderr, "Output, c2: [");
  for (int i = 0; i < 32; i++)
    fprintf(stderr, "%f, ", output32[i]);
  fprintf(stderr, "]\n");

  return 0;
}
