#include "../src/filters.h"
#include "../src/grfilter.h"
#include "../src/matrices.h"

#define LEN 32

int main(int argc, char *argv[]) {

  double input32[32] = {0.3041, 0.4868, 0.9101, 0.8521, 0.9781, 0.6740, 0.9982,
                        0.1307, 0.7803, 0.9581, 0.6719, 0.4030, 0.6437, 0.0349,
                        0.7468, 0.2155, 0.8643, 0.6717, 0.6606, 0.9273, 0.1661,
                        0.1734, 0.6295, 0.3849, 0.9915, 0.6498, 0.5767, 0.3216,
                        0.8256, 0.0776, 0.2773, 0.6198};
  double output32[32];

  double coeffs2[2] = {0.8, 0.4};
  double coeffs3[3] = {0.8, 0.4, 0.2};
  double coeffs5[5] = {0.8, 0.7, 0.5, 0.3, 0.2};

  chebyshev_gf(input32, output32, LEN, 2, coeffs2, NE_LD32, MEV_LD32, Ld32_a,
               Ld32_w);
  // MATLAB output: [-0.0366, -0.0482, 0.0965, -0.0369, 0.0862, -0.1260, 0.2389,
  // -0.3042, 0.0946, 0.0930, -0.0035, -0.1022, 0.1703, -0.2648, 0.2492,
  // -0.2366, 0.1687, -0.0364, -0.0557, 0.2061, -0.1541, -0.0900, 0.1405,
  // -0.1707, 0.1901, -0.0538, 0.0365, -0.1522, 0.2510, -0.1900, -0.0286,
  // 0.0687]
  fprintf(stderr, "Output, c2: [");
  for (int i = 0; i < 32; i++)
    fprintf(stderr, "%f, ", output32[i]);
  fprintf(stderr, "]\n");

  chebyshev_gf(input32, output32, LEN, 3, coeffs3, NE_LD32, MEV_LD32, Ld32_a,
               Ld32_w);
  // MATLAB output: [0.1033, 0.0672, 0.2249, 0.0788, 0.2775, -0.0285, 0.4158,
  // -0.1417, 0.2621, 0.1462, 0.1390, -0.0033, 0.3131, -0.2039, 0.4013, -0.1669,
  // 0.3101, 0.0776, 0.0469, 0.2911, -0.0253, 0.0413, 0.2569, -0.0891, 0.3113,
  // 0.0163, 0.2187, -0.0801, 0.3372, -0.0964, 0.1162, 0.1041]
  fprintf(stderr, "Output, c3: [");
  for (int i = 0; i < 32; i++)
    fprintf(stderr, "%f, ", output32[i]);
  fprintf(stderr, "]\n");

  chebyshev_gf(input32, output32, LEN, 5, coeffs5, NE_LD32, MEV_LD32, Ld32_a,
               Ld32_w);
  // MATLAB output: [0.1133, -0.0042, 0.2207, -0.1860, 0.3561, -0.2930, 0.4516,
  // -0.2913, 0.3548, -0.1713, 0.3023, -0.2509, 0.4550, -0.3953, 0.5705,
  // -0.3727, 0.3297, -0.0977, 0.0408, 0.1309, 0.0295, 0.0021, 0.2366, -0.1996,
  // 0.3674, -0.3121, 0.3730, -0.2769, 0.3809, -0.2116, 0.2074, 0.0006]
  fprintf(stderr, "Output, c5: [");
  for (int i = 0; i < 32; i++)
    fprintf(stderr, "%f, ", output32[i]);
  fprintf(stderr, "]\n");

  return 0;
}
