#ifndef GRFILTER_H_
#define GRFILTER_H_

#include <assert.h>
#include <math.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>

#define CONFIG_DEBUG 0
#define MAX_GRAPH_SIZE 256
#define MAX_EDGE_NUMBER MAX_GRAPH_SIZE *MAX_GRAPH_SIZE
#define BATCH_SIZE 50

#if CONFIG_DEBUG
void show_coefficients(const double *input, const double *output, int n);
#endif

static const double h4x4_tik[16] = {
1.0000000000, 0.8722604191, 0.6666666667, 0.5395042868, 0.8722604191, 
0.7734590803, 0.6073686169, 0.5000000000, 0.6666666667, 0.6073686169, 
0.5000000000, 0.4248894476, 0.5395042868, 0.5000000000, 0.4248894476, 
0.3693980625
};

static const double h4x4_diff[16] = {
1.0000000000, 0.7461018061, 0.3678794412, 0.1813898346, 0.7461018061, 
0.5566679050, 0.2744755155, 0.1353352832, 0.3678794412, 0.2744755155, 
0.1353352832, 0.0667295910, 0.1813898346, 0.1353352832, 0.0667295910, 
0.0329022721
};

static const double h4x4_lp[16] = {
1.0000000000, 1.0000000000, 1.0000000000, 0.0000000000, 1.0000000000, 
1.0000000000, 0.0000000000, 0.0000000000, 1.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000
};

static const double h4x4_exp[16] = {
0.0111089965, 0.0542466759, 0.6065306597, 0.9177902157, 0.0542466759, 
0.1879512092, 0.9177902157, 0.6065306597, 0.6065306597, 0.9177902157, 
0.6065306597, 0.0542466759, 0.9177902157, 0.6065306597, 0.0542466759, 
0.0006566055
};

static const double h8x8_tik[64] = {
1.0000000000, 0.9633352358, 0.8722604191, 0.7641414205, 0.6666666667, 
0.5912465769, 0.5395042868, 0.5096996438, 0.9633352358, 0.9292639906, 
0.8442331978, 0.7425456671, 0.6501695955, 0.5782345741, 0.5286491846, 
0.5000000000, 0.8722604191, 0.8442331978, 0.7734590803, 0.6872356795, 
0.6073686169, 0.5441323062, 0.5000000000, 0.4742963678, 0.7641414205, 
0.7425456671, 0.6872356795, 0.6183081408, 0.5528960384, 0.5000000000, 
0.4624894093, 0.4404126041, 0.6666666667, 0.6501695955, 0.6073686169, 
0.5528960384, 0.5000000000, 0.4563414243, 0.4248894476, 0.4061837798, 
0.5912465769, 0.5782345741, 0.5441323062, 0.5000000000, 0.4563414243, 
0.4196948644, 0.3929435038, 0.3768917873, 0.5395042868, 0.5286491846, 
0.5000000000, 0.4624894093, 0.4248894476, 0.3929435038, 0.3693980625, 
0.3551775637, 0.5096996438, 0.5000000000, 0.4742963678, 0.4404126041, 
0.4061837798, 0.3768917873, 0.3551775637, 0.3420113547
};

static const double h8x8_diff[64] = {
1.0000000000, 0.9267045621, 0.7461018061, 0.5393899137, 0.3678794412, 
0.2509043640, 0.1813898346, 0.1460392975, 0.9267045621, 0.8587813453, 
0.6914159475, 0.4998550937, 0.3409155564, 0.2325142188, 0.1680947873, 
0.1353352832, 0.7461018061, 0.6914159475, 0.5566679050, 0.4024397888, 
0.2744755155, 0.1872001991, 0.1353352832, 0.1089601836, 0.5393899137, 
0.4998550937, 0.4024397888, 0.2909414790, 0.1984304600, 0.1353352832, 
0.0978398473, 0.0787721241, 0.3678794412, 0.3409155564, 0.2744755155, 
0.1984304600, 0.1353352832, 0.0923025572, 0.0667295910, 0.0537248552, 
0.2509043640, 0.2325142188, 0.1872001991, 0.1353352832, 0.0923025572, 
0.0629529999, 0.0455115011, 0.0366418971, 0.1813898346, 0.1680947873, 
0.1353352832, 0.0978398473, 0.0667295910, 0.0455115011, 0.0329022721, 
0.0264900440, 0.1460392975, 0.1353352832, 0.1089601836, 0.0787721241, 
0.0537248552, 0.0366418971, 0.0264900440, 0.0213274764
};

static const double h8x8_lp[64] = {
1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 
1.0000000000, 0.0000000000, 0.0000000000, 1.0000000000, 1.0000000000, 
1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 0.0000000000, 
0.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 
1.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 1.0000000000, 
1.0000000000, 1.0000000000, 1.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
1.0000000000, 1.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000
};

static const double h8x8_exp[64] = {
0.0022626563, 0.0038050249, 0.0147251501, 0.0785442387, 0.3293784912, 
0.7689043533, 0.9971070299, 0.9381210118, 0.0038050249, 0.0062521680, 
0.0226499878, 0.1094517024, 0.4085068626, 0.8487355143, 0.9971070299, 
0.8782010717, 0.0147251501, 0.0226499878, 0.0679946233, 0.2480048078, 
0.6642456964, 0.9903611173, 0.8782010717, 0.6409371087, 0.0785442387, 
0.1094517024, 0.2480048078, 0.5937542982, 0.9678371167, 0.8782010717, 
0.5111583773, 0.2815839621, 0.3293784912, 0.4085068626, 0.6642456964, 
0.9678371167, 0.8782010717, 0.4435900894, 0.1571340168, 0.0621175701, 
0.7689043533, 0.8487355143, 0.9903611173, 0.8782010717, 0.4435900894, 
0.1247285545, 0.0268894008, 0.0076281142, 0.9971070299, 0.9971070299, 
0.8782010717, 0.5111583773, 0.1571340168, 0.0268894008, 0.0038050249, 
0.0008147503, 0.9381210118, 0.8782010717, 0.6409371087, 0.2815839621, 
0.0621175701, 0.0076281142, 0.0008147503, 0.0001445642
};

static const double h16x16_tik[256] = {
1.0000000000, 0.9904840632, 0.9633352358, 0.9222835942, 0.8722604191, 
0.8181867309, 0.7641414205, 0.7130354377, 0.6666666667, 0.6259603950, 
0.5912465769, 0.5624976780, 0.5395042868, 0.5219929172, 0.5096996438, 
0.5024134333, 0.9904840632, 0.9811475254, 0.9545012236, 0.9141832809, 
0.8650115190, 0.8118054414, 0.7585724507, 0.7081841018, 0.6624239035, 
0.6222184809, 0.5879070774, 0.5594742136, 0.5367223412, 0.5193881990, 
0.5072158747, 0.5000000000, 0.9633352358, 0.9545012236, 0.9292639906, 
0.8910071673, 0.8442331978, 0.7934775402, 0.7425456671, 0.6941961378, 
0.6501695955, 0.6113944129, 0.5782345741, 0.5507076910, 0.5286491846, 
0.5118244133, 0.5000000000, 0.4929865578, 0.9222835942, 0.9141832809, 
0.8910071673, 0.8557757766, 0.8125379129, 0.7654154222, 0.7179145273, 
0.6726215951, 0.6312074543, 0.5945973618, 0.5631877159, 0.5370424174, 
0.5160441788, 0.5000000000, 0.4887095963, 0.4820071935, 0.8722604191, 
0.8650115190, 0.8442331978, 0.8125379129, 0.7734590803, 0.7306408525, 
0.6872356795, 0.6456188682, 0.6073686169, 0.5733972012, 0.5441323062, 
0.5196879287, 0.5000000000, 0.4849233886, 0.4742963678, 0.4679809210, 
0.8181867309, 0.8118054414, 0.7934775402, 0.7654154222, 0.7306408525, 
0.6923147271, 0.6532219790, 0.6155097163, 0.5806476355, 0.5495230006, 
0.5225871031, 0.5000000000, 0.4817493419, 0.4677378541, 0.4578430379, 
0.4519554369, 0.7641414205, 0.7585724507, 0.7425456671, 0.7179145273, 
0.6872356795, 0.6532219790, 0.6183081408, 0.5844148973, 0.5528960384, 
0.5246029760, 0.5000000000, 0.4792845087, 0.4624894093, 0.4495608283, 
0.4404126041, 0.4349620922, 0.7130354377, 0.7081841018, 0.6941961378, 
0.6726215951, 0.6456188682, 0.6155097163, 0.5844148973, 0.5540443448, 
0.5256366561, 0.5000000000, 0.4776013207, 0.4586651105, 0.4432607944, 
0.4313710926, 0.4229412458, 0.4179121355, 0.6666666667, 0.6624239035, 
0.6501695955, 0.6312074543, 0.6073686169, 0.5806476355, 0.5528960384, 
0.5256366561, 0.5000000000, 0.4767477805, 0.4563414243, 0.4390229758, 
0.4248894476, 0.4139527226, 0.4061837798, 0.4015431076, 0.6259603950, 
0.6222184809, 0.6113944129, 0.5945973618, 0.5733972012, 0.5495230006, 
0.5246029760, 0.5000000000, 0.4767477805, 0.4555621197, 0.4368935879, 
0.4209940864, 0.4079803317, 0.3978864325, 0.3907036097, 0.3864080503, 
0.5912465769, 0.5879070774, 0.5782345741, 0.5631877159, 0.5441323062, 
0.5225871031, 0.5000000000, 0.4776013207, 0.4563414243, 0.4368935879, 
0.4196948644, 0.4050014713, 0.3929435038, 0.3835714032, 0.3768917873, 
0.3728930114, 0.5624976780, 0.5594742136, 0.5507076910, 0.5370424174, 
0.5196879287, 0.5000000000, 0.4792845087, 0.4586651105, 0.4390229758, 
0.4209940864, 0.4050014713, 0.3913021004, 0.3800347227, 0.3712614084, 
0.3650001525, 0.3612484775, 0.5395042868, 0.5367223412, 0.5286491846, 
0.5160441788, 0.5000000000, 0.4817493419, 0.4624894093, 0.4432607944, 
0.4248894476, 0.4079803317, 0.3929435038, 0.3800347227, 0.3693980625, 
0.3611036226, 0.3551775637, 0.3516241128, 0.5219929172, 0.5193881990, 
0.5118244133, 0.5000000000, 0.4849233886, 0.4677378541, 0.4495608283, 
0.4313710926, 0.4139527226, 0.3978864325, 0.3835714032, 0.3712614084, 
0.3611036226, 0.3531734883, 0.3475028099, 0.3441005319, 0.5096996438, 
0.5072158747, 0.5000000000, 0.4887095963, 0.4742963678, 0.4578430379, 
0.4404126041, 0.4229412458, 0.4061837798, 0.3907036097, 0.3768917873, 
0.3650001525, 0.3551775637, 0.3475028099, 0.3420113547, 0.3387152469, 
0.5024134333, 0.5000000000, 0.4929865578, 0.4820071935, 0.4679809210, 
0.4519554369, 0.4349620922, 0.4179121355, 0.4015431076, 0.3864080503, 
0.3728930114, 0.3612484775, 0.3516241128, 0.3441005319, 0.3387152469, 
0.3354820646
};

static const double h16x16_diff[256] = {
1.0000000000, 0.9809687064, 0.9267045621, 0.8449055883, 0.7461018061, 
0.6411897994, 0.5393899137, 0.4471283103, 0.3678794412, 0.3026766146, 
0.2509043640, 0.2110689898, 0.1813898346, 0.1601779952, 0.1460392975, 
0.1379608568, 0.9809687064, 0.9622996030, 0.9090681755, 0.8288259420, 
0.7319025236, 0.6289871281, 0.5291246259, 0.4386188801, 0.3608782195, 
0.2969162871, 0.2461293294, 0.2070520739, 0.1779377515, 0.1571296007, 
0.1432599808, 0.1353352832, 0.9267045621, 0.9090681755, 0.8587813453, 
0.7829778632, 0.6914159475, 0.5941935123, 0.4998550937, 0.4143558450, 
0.3409155564, 0.2804917996, 0.2325142188, 0.1955985958, 0.1680947873, 
0.1484376789, 0.1353352832, 0.1278489554, 0.8449055883, 0.8288259420, 
0.7829778632, 0.7138654531, 0.6303855854, 0.5417448447, 0.4557335523, 
0.3777812080, 0.3108233957, 0.2557331631, 0.2119904993, 0.1783333690, 
0.1532572850, 0.1353352832, 0.1233894186, 0.1165638989, 0.7461018061, 
0.7319025236, 0.6914159475, 0.6303855854, 0.5566679050, 0.4783928674, 
0.4024397888, 0.3336032398, 0.2744755155, 0.2258275688, 0.1872001991, 
0.1574789545, 0.1353352832, 0.1195090915, 0.1089601836, 0.1029328444, 
0.6411897994, 0.6289871281, 0.5941935123, 0.5417448447, 0.4783928674, 
0.4111243589, 0.3458513105, 0.2866941116, 0.2358805451, 0.1940731578, 
0.1608773188, 0.1353352832, 0.1163053117, 0.1027044966, 0.0936389079, 
0.0884590941, 0.5393899137, 0.5291246259, 0.4998550937, 0.4557335523, 
0.4024397888, 0.3458513105, 0.2909414790, 0.2411765007, 0.1984304600, 
0.1632607130, 0.1353352832, 0.1138484842, 0.0978398473, 0.0863983950, 
0.0787721241, 0.0744146946, 0.4471283103, 0.4386188801, 0.4143558450, 
0.3777812080, 0.3336032398, 0.2866941116, 0.2411765007, 0.1999237258, 
0.1644893129, 0.1353352832, 0.1121864443, 0.0943749208, 0.0811045303, 
0.0716201163, 0.0652983043, 0.0616862048, 0.3678794412, 0.3608782195, 
0.3409155564, 0.3108233957, 0.2744755155, 0.2358805451, 0.1984304600, 
0.1644893129, 0.1353352832, 0.1113485038, 0.0923025572, 0.0776479420, 
0.0667295910, 0.0589261913, 0.0537248552, 0.0507529629, 0.3026766146, 
0.2969162871, 0.2804917996, 0.2557331631, 0.2258275688, 0.1940731578, 
0.1632607130, 0.1353352832, 0.1113485038, 0.0916131330, 0.0759428835, 
0.0638856473, 0.0549024611, 0.0484821333, 0.0442026802, 0.0417575251, 
0.2509043640, 0.2461293294, 0.2325142188, 0.2119904993, 0.1872001991, 
0.1608773188, 0.1353352832, 0.1121864443, 0.0923025572, 0.0759428835, 
0.0629529999, 0.0529581306, 0.0455115011, 0.0401893580, 0.0366418971, 
0.0346149810, 0.2110689898, 0.2070520739, 0.1955985958, 0.1783333690, 
0.1574789545, 0.1353352832, 0.1138484842, 0.0943749208, 0.0776479420, 
0.0638856473, 0.0529581306, 0.0445501185, 0.0382857692, 0.0338086076, 
0.0308243670, 0.0291192587, 0.1813898346, 0.1779377515, 0.1680947873, 
0.1532572850, 0.1353352832, 0.1163053117, 0.0978398473, 0.0811045303, 
0.0667295910, 0.0549024611, 0.0455115011, 0.0382857692, 0.0329022721, 
0.0290546601, 0.0264900440, 0.0250246970, 0.1601779952, 0.1571296007, 
0.1484376789, 0.1353352832, 0.1195090915, 0.1027044966, 0.0863983950, 
0.0716201163, 0.0589261913, 0.0484821333, 0.0401893580, 0.0338086076, 
0.0290546601, 0.0256569901, 0.0233922819, 0.0220982935, 0.1460392975, 
0.1432599808, 0.1353352832, 0.1233894186, 0.1089601836, 0.0936389079, 
0.0787721241, 0.0652983043, 0.0537248552, 0.0442026802, 0.0366418971, 
0.0308243670, 0.0264900440, 0.0233922819, 0.0213274764, 0.0201477066, 
0.1379608568, 0.1353352832, 0.1278489554, 0.1165638989, 0.1029328444, 
0.0884590941, 0.0744146946, 0.0616862048, 0.0507529629, 0.0417575251, 
0.0346149810, 0.0291192587, 0.0250246970, 0.0220982935, 0.0201477066, 
0.0190331980
};

static const double h16x16_lp[256] = {
1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 
1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 
1.0000000000, 1.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 
1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 
1.0000000000, 1.0000000000, 1.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 
1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 
1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 1.0000000000, 1.0000000000, 
1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 
1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 1.0000000000, 
1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 
1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 
1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 
1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 
1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 1.0000000000, 1.0000000000, 
1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 1.0000000000, 
1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000
};

static const double h16x16_exp[256] = {
0.0007798537, 0.0009012253, 0.0013712524, 0.0026372154, 0.0060251442, 
0.0151662573, 0.0388648134, 0.0942456192, 0.2039358674, 0.3789733393, 
0.5956989359, 0.7978375117, 0.9341805507, 0.9927915024, 0.9979199886, 
0.9842226192, 0.0009012253, 0.0010399494, 0.0015754215, 0.0030084333, 
0.0068078670, 0.0169380668, 0.0428322761, 0.1023797338, 0.2182400450, 
0.3995190491, 0.6190046540, 0.8181080878, 0.9468231298, 0.9966551924, 
0.9947135128, 0.9767786506, 0.0013712524, 0.0015754215, 0.0023558947, 
0.0044051863, 0.0096903848, 0.0232923654, 0.0566278550, 0.1296965309, 
0.2644618751, 0.4631059789, 0.6875308930, 0.8736112008, 0.9767786506, 
0.9994896360, 0.9767786506, 0.9468231298, 0.0026372154, 0.0030084333, 
0.0044051863, 0.0079604550, 0.0167243929, 0.0380098710, 0.0866879966, 
0.1852432658, 0.3514461661, 0.5726085035, 0.7931491011, 0.9454245314, 
0.9994896360, 0.9767786506, 0.9225273047, 0.8756220887, 0.0060251442, 
0.0068078670, 0.0096903848, 0.0167243929, 0.0330290011, 0.0696151017, 
0.1456852238, 0.2835771830, 0.4882477840, 0.7219246643, 0.9108801514, 
0.9962830502, 0.9767786506, 0.8973185188, 0.8094041529, 0.7468080133, 
0.0151662573, 0.0169380668, 0.0232923654, 0.0380098710, 0.0696151017, 
0.1338505324, 0.2522437399, 0.4382208627, 0.6703557050, 0.8806435772, 
0.9917139108, 0.9767786506, 0.8736112008, 0.7442702410, 0.6347795324, 
0.5658303632, 0.0388648134, 0.0428322761, 0.0566278550, 0.0866879966, 
0.1456852238, 0.2522437399, 0.4217904189, 0.6436185625, 0.8602968709, 
0.9875309769, 0.9767786506, 0.8536541025, 0.6875308930, 0.5374699038, 
0.4300237730, 0.3685233441, 0.0942456192, 0.1023797338, 0.1296965309, 
0.1852432658, 0.2835771830, 0.4382208627, 0.6436185625, 0.8531533082, 
0.9850773149, 0.9767786506, 0.8392826733, 0.6442482218, 0.4631059789, 
0.3297726523, 0.2461717234, 0.2021464461, 0.2039358674, 0.2182400450, 
0.2644618751, 0.3514461661, 0.4882477840, 0.6703557050, 0.8602968709, 
0.9850773149, 0.9767786506, 0.8317725840, 0.6173623732, 0.4140880045, 
0.2644618751, 0.1709030989, 0.1187012068, 0.0932389438, 0.3789733393, 
0.3995190491, 0.4631059789, 0.5726085035, 0.7219246643, 0.8806435772, 
0.9875309769, 0.9767786506, 0.8317725840, 0.6082689479, 0.3899910659, 
0.2285676027, 0.1296965309, 0.0760620174, 0.0491535291, 0.0369327105, 
0.5956989359, 0.6190046540, 0.6875308930, 0.7931491011, 0.9108801514, 
0.9917139108, 0.9767786506, 0.8392826733, 0.6173623732, 0.3899910659, 
0.2172102609, 0.1118148667, 0.0566278550, 0.0302511513, 0.0182395444, 
0.0131318487, 0.7978375117, 0.8181080878, 0.8736112008, 0.9454245314, 
0.9962830502, 0.9767786506, 0.8536541025, 0.6442482218, 0.4140880045, 
0.2285676027, 0.1118148667, 0.0510734015, 0.0232923654, 0.0114176010, 
0.0064579250, 0.0044700675, 0.9341805507, 0.9468231298, 0.9767786506, 
0.9994896360, 0.9767786506, 0.8736112008, 0.6875308930, 0.4631059789, 
0.2644618751, 0.1296965309, 0.0566278550, 0.0232923654, 0.0096903848, 
0.0044051863, 0.0023558947, 0.0015754215, 0.9927915024, 0.9966551924, 
0.9994896360, 0.9767786506, 0.8973185188, 0.7442702410, 0.5374699038, 
0.3297726523, 0.1709030989, 0.0760620174, 0.0302511513, 0.0114176010, 
0.0044051863, 0.0018824357, 0.0009614960, 0.0006250207, 0.9979199886, 
0.9947135128, 0.9767786506, 0.9225273047, 0.8094041529, 0.6347795324, 
0.4300237730, 0.2461717234, 0.1187012068, 0.0491535291, 0.0182395444, 
0.0064579250, 0.0023558947, 0.0009614960, 0.0004746134, 0.0003021007, 
0.9842226192, 0.9767786506, 0.9468231298, 0.8756220887, 0.7468080133, 
0.5658303632, 0.3685233441, 0.2021464461, 0.0932389438, 0.0369327105, 
0.0131318487, 0.0044700675, 0.0015754215, 0.0006250207, 0.0003021007, 
0.0001898183
};

static const double h32_tik[32] = {
1.0000000000, 0.9975981461, 0.9904840632, 0.9789239321, 0.9633352358, 
0.9442519611, 0.9222835942, 0.8980733668, 0.8722604191, 0.8454490709, 
0.8181867309, 0.7909504939, 0.7641414205, 0.7380849136, 0.7130354377, 
0.6891839465, 0.6666666667, 0.6455742204, 0.6259603950, 0.6078501395, 
0.5912465769, 0.5761369707, 0.5624976780, 0.5502981773, 0.5395042868, 
0.5300806941, 0.5219929172, 0.5152088010, 0.5096996438, 0.5054410303, 
0.5024134333, 0.5006026346
};

static const double h32_diff[32] = {
1.0000000000, 0.9951963015, 0.9809687064, 0.9578542387, 0.9267045621, 
0.8886260833, 0.8449055883, 0.7969291128, 0.7461018061, 0.6937755985, 
0.6411897994, 0.5894276703, 0.5393899137, 0.4917841773, 0.4471283103, 
0.4057642879, 0.3678794412, 0.3335317752, 0.3026766146, 0.2751924309, 
0.2509043640, 0.2296045640, 0.2110689898, 0.1950706879, 0.1813898346, 
0.1698209804, 0.1601779952, 0.1522972213, 0.1460392975, 0.1412900604, 
0.1379608568, 0.1359885311
};

static const double h32_lp[32] = {
1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 
1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 
1.0000000000, 1.0000000000, 1.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000
};

static const double h32_exp[32] = {
0.1638556537, 0.1668769377, 0.1761506515, 0.1923035469, 0.2163628539, 
0.2497019900, 0.2939073889, 0.3505130104, 0.4205522667, 0.5039135634, 
0.5985714157, 0.6998959998, 0.8003726660, 0.8900938969, 0.9582182041, 
0.9952078393, 0.9952078393, 0.9576881087, 0.8876581837, 0.7943430839, 
0.6888608621, 0.5817913695, 0.4814123698, 0.3929487082, 0.3187268384, 
0.2588696696, 0.2121453429, 0.1767072777, 0.1506158805, 0.1321435559, 
0.1199175628, 0.1129647696
};

static const double h64_tik[64] = {
1.0000000000, 0.9993980906, 0.9975981461, 0.9946173843, 0.9904840632, 
0.9852368433, 0.9789239321, 0.9716020470, 0.9633352358, 0.9541935990, 
0.9442519611, 0.9335885310, 0.9222835942, 0.9104182706, 0.8980733668, 
0.8853283444, 0.8722604191, 0.8589438003, 0.8454490709, 0.8318427074, 
0.8181867309, 0.8045384802, 0.7909504939, 0.7774704892, 0.7641414205, 
0.7510016071, 0.7380849136, 0.7254209728, 0.7130354377, 0.7009502545, 
0.6891839465, 0.6777519032, 0.6666666667, 0.6559382125, 0.6455742204, 
0.6355803321, 0.6259603950, 0.6167166893, 0.6078501395, 0.5993605087, 
0.5912465769, 0.5835063027, 0.5761369707, 0.5691353229, 0.5624976780, 
0.5562200369, 0.5502981773, 0.5447277368, 0.5395042868, 0.5346233974, 
0.5300806941, 0.5258719077, 0.5219929172, 0.5184397873, 0.5152088010, 
0.5122964870, 0.5096996438, 0.5074153598, 0.5054410303, 0.5037743716, 
0.5024134333, 0.5013566071, 0.5006026346, 0.5001506133
};

static const double h64_diff[64] = {
1.0000000000, 0.9987961814, 0.9951963015, 0.9892348732, 0.9809687064, 
0.9704758635, 0.9578542387, 0.9432198026, 0.9267045621, 0.9084542893, 
0.8886260833, 0.8673858247, 0.8449055883, 0.8213610739, 0.7969291128, 
0.7717853014, 0.7461018061, 0.7200453771, 0.6937755985, 0.6674433939, 
0.6411897994, 0.6151450066, 0.5894276703, 0.5641444707, 0.5393899137, 
0.5152463482, 0.4917841773, 0.4690622359, 0.4471283103, 0.4260197699, 
0.4057642879, 0.3863806229, 0.3678794412, 0.3502641572, 0.3335317752, 
0.3176737156, 0.3026766146, 0.2885230847, 0.2751924309, 0.2626613147, 
0.2509043640, 0.2398947260, 0.2296045640, 0.2200054975, 0.2110689898, 
0.2027666833, 0.1950706879, 0.1879538256, 0.1813898346, 0.1753535381, 
0.1698209804, 0.1647695362, 0.1601779952, 0.1560266255, 0.1522972213, 
0.1489731347, 0.1460392975, 0.1434822327, 0.1412900604, 0.1394524978, 
0.1379608568, 0.1368080391, 0.1359885311, 0.1354983987
};

static const double h64_lp[64] = {
1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 
1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 
1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 
1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 
1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 
1.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000
};

static const double h64_exp[64] = {
0.1491103759, 0.1498124044, 0.1519313813, 0.1555059985, 0.1606007760, 
0.1673060135, 0.1757375206, 0.1860359180, 0.1983652284, 0.2129104130, 
0.2298734358, 0.2494673937, 0.2719082215, 0.2974035095, 0.3261380601, 
0.3582560010, 0.3938395651, 0.4328850733, 0.4752771886, 0.5207631318, 
0.5689291852, 0.6191823699, 0.6707405341, 0.7226341034, 0.7737222924, 
0.8227255889, 0.8682748057, 0.9089750715, 0.9434810218, 0.9705774879, 
0.9892585145, 0.9987969060, 0.9987969060, 0.9892241154, 0.9704091579, 
0.9430245820, 0.9080375536, 0.8666435660, 0.8201882482, 0.7700851636, 
0.7177371888, 0.6644678380, 0.6114670138, 0.5597535208, 0.5101545987, 
0.4633010130, 0.4196350381, 0.3794280278, 0.3428041491, 0.3097671305, 
0.2802274201, 0.2540278057, 0.2309662204, 0.2108150540, 0.1933367673, 
0.1782959610, 0.1654682675, 0.1546465595, 0.1456450030, 0.1383014663, 
0.1324787457, 0.1280649994, 0.1249737081, 0.1231434078
};

static const double h128_tik[128] = {
1.0000000000, 0.9998494320, 0.9993980906, 0.9986470613, 0.9975981461, 
0.9962538537, 0.9946173843, 0.9926926122, 0.9904840632, 0.9879968900, 
0.9852368433, 0.9822102404, 0.9789239321, 0.9753852655, 0.9716020470, 
0.9675825023, 0.9633352358, 0.9588691890, 0.9541935990, 0.9493179559, 
0.9442519611, 0.9390054860, 0.9335885310, 0.9280111865, 0.9222835942, 
0.9164159103, 0.9104182706, 0.9043007571, 0.8980733668, 0.8917459822, 
0.8853283444, 0.8788300281, 0.8722604191, 0.8656286937, 0.8589438003, 
0.8522144437, 0.8454490709, 0.8386558595, 0.8318427074, 0.8250172255, 
0.8181867309, 0.8113582430, 0.8045384802, 0.7977338590, 0.7909504939, 
0.7841941988, 0.7774704892, 0.7707845862, 0.7641414205, 0.7575456384, 
0.7510016071, 0.7445134220, 0.7380849136, 0.7317196557, 0.7254209728, 
0.7191919493, 0.7130354377, 0.7069540676, 0.7009502545, 0.6950262092, 
0.6891839465, 0.6834252945, 0.6777519032, 0.6721652537, 0.6666666667, 
0.6612573111, 0.6559382125, 0.6507102612, 0.6455742204, 0.6405307335, 
0.6355803321, 0.6307234430, 0.6259603950, 0.6212914260, 0.6167166893, 
0.6122362597, 0.6078501395, 0.6035582644, 0.5993605087, 0.5952566905, 
0.5912465769, 0.5873298881, 0.5835063027, 0.5797754613, 0.5761369707, 
0.5725904077, 0.5691353229, 0.5657712437, 0.5624976780, 0.5593141167, 
0.5562200369, 0.5532149047, 0.5502981773, 0.5474693057, 0.5447277368, 
0.5420729155, 0.5395042868, 0.5370212973, 0.5346233974, 0.5323100423, 
0.5300806941, 0.5279348228, 0.5258719077, 0.5238914387, 0.5219929172, 
0.5201758574, 0.5184397873, 0.5167842492, 0.5152088010, 0.5137130166, 
0.5122964870, 0.5109588205, 0.5096996438, 0.5085186021, 0.5074153598, 
0.5063896011, 0.5054410303, 0.5045693719, 0.5037743716, 0.5030557961, 
0.5024134333, 0.5018470931, 0.5013566071, 0.5009418289, 0.5006026346, 
0.5003389225, 0.5001506133, 0.5000376505
};

static const double h128_diff[128] = {
1.0000000000, 0.9996988640, 0.9987961814, 0.9972941242, 0.9951963015, 
0.9925077425, 0.9892348732, 0.9853854864, 0.9809687064, 0.9759949469, 
0.9704758635, 0.9644243017, 0.9578542387, 0.9507807219, 0.9432198026, 
0.9351884669, 0.9267045621, 0.9177867220, 0.9084542893, 0.8987272360, 
0.8886260833, 0.8781718207, 0.8673858247, 0.8562897777, 0.8449055883, 
0.8332553119, 0.8213610739, 0.8092449938, 0.7969291128, 0.7844353232, 
0.7717853014, 0.7590004437, 0.7461018061, 0.7331100476, 0.7200453771, 
0.7069275051, 0.6937755985, 0.6806082404, 0.6674433939, 0.6542983698, 
0.6411897994, 0.6281336102, 0.6151450066, 0.6022384548, 0.5894276703, 
0.5767256107, 0.5641444707, 0.5516956817, 0.5393899137, 0.5272370805, 
0.5152463482, 0.5034261456, 0.4917841773, 0.4803274393, 0.4690622359, 
0.4579941995, 0.4471283103, 0.4364689190, 0.4260197699, 0.4157840248, 
0.4057642879, 0.3959626318, 0.3863806229, 0.3770193482, 0.3678794412, 
0.3589611088, 0.3502641572, 0.3417880183, 0.3335317752, 0.3254941873, 
0.3176737156, 0.3100685463, 0.3026766146, 0.2954956272, 0.2885230847, 
0.2817563024, 0.2751924309, 0.2688284755, 0.2626613147, 0.2566877184, 
0.2509043640, 0.2453078531, 0.2398947260, 0.2346614763, 0.2296045640, 
0.2247204279, 0.2200054975, 0.2154562040, 0.2110689898, 0.2068403185, 
0.2027666833, 0.1988446146, 0.1950706879, 0.1914415301, 0.1879538256, 
0.1846043219, 0.1813898346, 0.1783072518, 0.1753535381, 0.1725257382, 
0.1698209804, 0.1672364788, 0.1647695362, 0.1624175463, 0.1601779952, 
0.1580484630, 0.1560266255, 0.1541102550, 0.1522972213, 0.1505854923, 
0.1489731347, 0.1474583146, 0.1460392975, 0.1447144485, 0.1434822327, 
0.1423412151, 0.1412900604, 0.1403275332, 0.1394524978, 0.1386639180, 
0.1379608568, 0.1373424767, 0.1368080391, 0.1363569043, 0.1359885311, 
0.1357024773, 0.1354983987, 0.1353760498
};

static const double h128_lp[128] = {
1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 
1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 
1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 
1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 
1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 
1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 
1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 
1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 
1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 
1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 
1.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 
0.0000000000, 0.0000000000, 0.0000000000
};

static const double h128_exp[128] = {
0.1421007908, 0.1422699574, 0.1427782534, 0.1436280683, 0.1448233863, 
0.1463697894, 0.1482744607, 0.1505461867, 0.1531953588, 0.1562339726, 
0.1596756222, 0.1635354899, 0.1678303275, 0.1725784279, 0.1777995844, 
0.1835150346, 0.1897473858, 0.1965205192, 0.2038594681, 0.2117902678, 
0.2203397719, 0.2295354322, 0.2394050372, 0.2499764063, 0.2612770353, 
0.2733336913, 0.2861719532, 0.2998156971, 0.3142865261, 0.3296031448, 
0.3457806811, 0.3628299601, 0.3807567353, 0.3995608870, 0.4192355974, 
0.4397665181, 0.4611309441, 0.4832970143, 0.5062229606, 0.5298564269, 
0.5541338852, 0.5789801734, 0.6043081837, 0.6300187253, 0.6560005886, 
0.6821308327, 0.7082753154, 0.7342894796, 0.7600194061, 0.7853031339, 
0.8099722422, 0.8338536815, 0.8567718301, 0.8785507461, 0.8990165752, 
0.9180000668, 0.9353391473, 0.9508814892, 0.9644870166, 0.9760302824, 
0.9854026561, 0.9925142623, 0.9972956162, 0.9996989094, 0.9996989094, 
0.9972934458, 0.9925034689, 0.9853726785, 0.9759667336, 0.9643720648, 
0.9506943255, 0.9350565219, 0.9175968778, 0.8984664890, 0.8778268311, 
0.8558471829, 0.8327020292, 0.8085685030, 0.7836239226, 0.7580434726, 
0.7319980727, 0.7056524660, 0.6791635535, 0.6526789920, 0.6263360612, 
0.6002608033, 0.5745674254, 0.5493579533, 0.5247221179, 0.5007374519, 
0.4774695722, 0.4549726216, 0.4332898415, 0.4124542496, 0.3924893958, 
0.3734101723, 0.3552236549, 0.3379299557, 0.3215230708, 0.3059917063, 
0.2913200726, 0.2774886367, 0.2644748248, 0.2522536725, 0.2407984169, 
0.2300810322, 0.2200727071, 0.2107442665, 0.2020665397, 0.1940106773, 
0.1865484225, 0.1796523379, 0.1732959947, 0.1674541259, 0.1621027500, 
0.1572192669, 0.1527825315, 0.1487729080, 0.1451723070, 0.1419642112, 
0.1391336886, 0.1366673991, 0.1345535948, 0.1327821155, 0.1313443829, 
0.1302333924, 0.1294437057, 0.1289714436
};

void mat_times_vec(const double *input, double *output, const double *gftmtx,
                   int n);

void exact_filter_4x4(const double *input, double *output, const double *h);
void exact_filter_8x8(const double *input, double *output, const double *h);
void exact_filter_16x16(const double *input, double *output, const double *h);
void exact_filter_32(const double *input, double *output, const double *h);
void exact_filter_64(const double *input, double *output, const double *h);
void apply_sparse_operator(const double *input, double *output, int n,
                           const int nedges, const double mev,
                           const int *adjlist, const double *wlist);
void buffer_add(const double *input, double *output, int dim, int len);
void pgf(const double *input, double *output, int n, int order,
         const double *coeffs, const int nedges, const double mev,
         const int *adjlist, const double *wlist);
void pgf_s(const double *input, double *output, int n, int order,
           const double *coeffs, const int nedges, const double mev,
           const int *adjlist, const double *wlist);
void chebyshev_gf(const double *input, double *output, int n, int order,
                  const double *coeffs, const int nedges, const double mev,
                  const int *adjlist, const double *wlist);
void armagf_cg(const double *input, double *output, int n, int tmax, int bord,
               const double *b, int aord, const double *a, const int nedges,
               const int *adjlist, const double *wlist);
void get_mpgf_terms(const int *powers, int ord, int m, int nops, int *idx_list,
                    int *pow_list);
void mpgf(const double *input, double *output, int n, int ord, int m,
          const double *coeffs, const int *idx_list, const int *pow_list,
          const int *nedges, const int *alists[], const double *wlists[]);
#endif
